<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>Text screen</title>
    </head>

    <body style="background:black;color:white;">
        <!-- Include Scala.js compiled code -->
        <script type="text/javascript" src="./target/scala-2.11/scalajs-shell-fastopt.js"></script>
        <!--script type="text/javascript" src="./target/scala-2.11/textscreen-jsdeps.js"></script-->

        <canvas id="screenCanvas" width="1024" height="600" style="border:1px solid #d3d3d3;">
            Your browser does not support the HTML5 canvas tag.</canvas>

        <script type="text/javascript">
            var screen = new CanvasTextScreen('screenCanvas');
            var input = new CanvasInputHandler('screenCanvas');
            var terminal = new Terminal(screen, input, 'typewriter-key-1.wav');

            var rootPassword = 'root';
            var vum = new VirtualUsersManagerImpl(rootPassword);

            vum.addUser('guest', 'guest');

            var fs = new InMemoryFS(vum);

            var currentFolder = fs.root;

            var bin = currentFolder.mkdir('bin');

            var usr = currentFolder.mkdir('usr');
            var usrBin = usr.mkdir('bin');
            currentFolder = currentFolder.mkdir('home');
            currentFolder = currentFolder.mkdir('guest');
            var text = currentFolder.touch('text.txt');
            text.content = 'Hello\nWorld';

            var shell = new VirtualShell(terminal, vum, currentFolder);
            shell.createCommandFile(bin, new LsCommand());
            shell.createCommandFile(bin, new CdCommand());
            shell.createCommandFile(bin, new CatCommand());
            shell.addToPath(bin);
            shell.addToPath(usrBin);

            vum.logUser('guest', 'guest');

            shell.start();

/*
            var audio = document.getElementById("audio");
            audio.play();
            audio.play();

            for (var i=0; i < 100; i++) {
                terminal.add('Hello world ' + i + '\n');
                screen.update();
            }
            screen.scroll_up(5, true);
            screen.update();
            screen.scroll_down(5, true);
            screen.update();
            terminal.add('Hello world\n');
            screen.update();
*/
        </script>

    </body>
</html>